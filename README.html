<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>机器学习笔记</title>
<!-- 2020-03-02 一 12:43 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="GoldenRaven" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="http://orgmode.org/mathjax/MathJax.js"></script>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
        //  config: ["MMLorHTML.js"], jax: ["input/TeX"],
            jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">机器学习笔记</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">目录&#xa0;&#xa0;&#xa0;<span class="tag"><span class="TOC_2">TOC@2</span>&#xa0;<span class="QUOTE">QUOTE</span></span></a></li>
<li><a href="#sec-2">Python笔记</a>
<ul>
<li><a href="#sec-2-1">常用函数</a></li>
</ul>
</li>
<li><a href="#sec-3">Pandas库笔记</a>
<ul>
<li><a href="#sec-3-1">Series</a></li>
<li><a href="#sec-3-2">DataFrame</a></li>
</ul>
</li>
<li><a href="#sec-4">Numpy库笔记</a>
<ul>
<li><a href="#sec-4-1">Copy or View?</a></li>
<li><a href="#sec-4-2">数组的in place改变</a></li>
<li><a href="#sec-4-3">常用函数</a></li>
</ul>
</li>
<li><a href="#sec-5">数据集操作的一般过程（以Kaggle Titanic为例）</a>
<ul>
<li><a href="#sec-5-1">加载数据</a></li>
<li><a href="#sec-5-2">预览数据</a></li>
<li><a href="#sec-5-3">清理数据</a>
<ul>
<li><a href="#sec-5-3-1">3.3.1 Completing</a></li>
<li><a href="#sec-5-3-2">3.3.2 Creating</a></li>
<li><a href="#sec-5-3-3">3.3.3 Converting</a></li>
</ul>
</li>
<li><a href="#sec-5-4">从训练集中分离出测试集</a></li>
<li><a href="#sec-5-5">分析数据，找到关联性</a></li>
<li><a href="#sec-5-6">模型化数据集</a>
<ul>
<li><a href="#sec-5-6-1">背景知识</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-6">注意点（摘自机器学习实战）</a></li>
<li><a href="#sec-7">机器学习实战</a>
<ul>
<li><a href="#sec-7-1">第四章 训练模型</a>
<ul>
<li><a href="#sec-7-1-1">4.1 线性回归 Linear Regression</a></li>
<li><a href="#sec-7-1-2">多项式回归 Polynomial Regression</a></li>
<li><a href="#sec-7-1-3">逻辑回归 Logistic Regression</a></li>
<li><a href="#sec-7-1-4">多元逻辑回归 Softmax Regression (Multinomial Regression)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">目录&#xa0;&#xa0;&#xa0;<span class="tag"><span class="TOC_2">TOC@2</span>&#xa0;<span class="QUOTE">QUOTE</span></span></h2>
<div class="outline-text-2" id="text-1">
<blockquote>
<ul class="org-ul">
<li><i>Python笔记</i>
<ul class="org-ul">
<li><i>常用函数</i>
</li>
</ul>
</li>
<li><i>Pandas库笔记</i>
<ul class="org-ul">
<li><i>Series</i>
</li>
<li><i>DataFrame</i>
</li>
</ul>
</li>
<li><i>Numpy库笔记</i>
<ul class="org-ul">
<li><i>Copy or View?</i>
</li>
<li><i>数组的in place改变</i>
</li>
<li><i>常用函数</i>
</li>
</ul>
</li>
<li><i>数据集操作的一般过程（以Kaggle Titanic为例）</i>
<ul class="org-ul">
<li><i>加载数据</i>
</li>
<li><i>预览数据</i>
</li>
<li><i>清理数据</i>
</li>
<li><i>从训练集中分离出测试集</i>
</li>
<li><i>分析数据，找到关联性</i>
</li>
<li><i>模型化数据集</i>
</li>
</ul>
</li>
<li><i>注意点（摘自机器学习实战）</i>
</li>
<li><i>机器学习实战</i>
<ul class="org-ul">
<li><i>第四章 训练模型</i>
</li>
</ul>
</li>
</ul>
</blockquote>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Python笔记</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">常用函数</h3>
<div class="outline-text-3" id="text-2-1">
<div class="org-src-container">

<pre class="src src-python">%timeit func() # 考查操作的运行时间
map(func_obj, iter1, iter2) # 但是请尽量用生成器
map(lambda x:x+1, iter1, iter2) # lambda表达式
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">Pandas库笔记</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1">Series</h3>
<div class="outline-text-3" id="text-3-1">
<div class="org-src-container">

<pre class="src src-python">import pandas as pd
pd.Series
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2">DataFrame</h3>
<div class="outline-text-3" id="text-3-2">
<ul class="org-ul">
<li>DataFrame中的方法属性：
</li>
</ul>
<div class="org-src-container">

<pre class="src src-example" id="df_methods">'T', 'abs', 'add', 'add_prefix', 'add_suffix', 'agg', 'aggregate', 'align', 'all',
'any', 'append', 'apply', 'applymap', 'asfreq', 'asof', 'assign', 'astype',
'at', 'at_time', 'attrs', 'axes', 'between_time', 'bfill', 'bool', 'boxplot',
'clip', 'columns', 'combine', 'combine_first', 'convert_dtypes', 'copy', 'corr',
'corrwith', 'count', 'cov', 'cummax', 'cummin', 'cumprod', 'cumsum', 'describe',
'diff', 'div', 'divide', 'dot', 'drop', 'drop_duplicates', 'droplevel', 'dropna',
'dtypes', 'duplicated', 'empty', 'eq', 'equals', 'eval', 'ewm', 'expanding',
'explode', 'ffill', 'fillna', 'filter', 'first', 'first_valid_index', 'floordiv',
'from_dict', 'from_records', 'ge', 'get', 'groupby', 'gt', 'head', 'hist', 'iat',
'idxmax', 'idxmin', 'iloc', 'index', 'infer_objects', 'info', 'insert',
'interpolate', 'isin', 'isna', 'isnull', 'items', 'iteritems', 'iterrows',
'itertuples', 'join', 'keys', 'kurt', 'kurtosis', 'last', 'last_valid_index',
'le', 'loc','lookup', 'lt', 'mad', 'mask', 'max', 'mean', 'median', 'melt',
'memory_usage', 'merge', 'min', 'mod', 'mode', 'mul', 'multiply', 'ndim', 'ne',
'nlargest', 'notna', 'notnull', 'nsmallest', 'nunique', 'pct_change', 'pipe',
'pivot', 'pivot_table', 'plot', 'pop', 'pow', 'prod', 'product', 'quantile',
'query', 'radd', 'rank', 'rdiv', 'reindex', 'reindex_like', 'rename',
'rename_axis', 'reorder_levels', 'replace', 'resample','reset_index', 'rfloordiv',
'rmod', 'rmul', 'rolling', 'round', 'rpow', 'rsub', 'rtruediv', 'sample',
'select_dtypes', 'sem', 'set_axis', 'set_index', 'shape', 'shift', 'size',
'skew', 'slice_shift', 'sort_index', 'sort_values', 'sparse', 'squeeze', 'stack',
'std', 'style', 'sub', 'subtract', 'sum', 'swapaxes', 'swaplevel', 'tail', 'take',
'to_clipboard', 'to_csv', 'to_dict', 'to_excel', 'to_feather', 'to_gbq', 'to_hdf',
'to_html', 'to_json', 'to_latex', 'to_markdown', 'to_numpy', 'to_parquet',
'to_period', 'to_pickle', 'to_records', 'to_sql', 'to_stata', 'to_string',
'to_timestamp', 'to_xarray', 'transform', 'transpose', 'truediv', 'truncate',
'tshift', 'tz_convert', 'tz_localize', 'unstack', 'update', 'values', 'var',
'where', 'xs'
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">Numpy库笔记</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1">Copy or View?</h3>
<div class="outline-text-3" id="text-4-1">
<ul class="org-ul">
<li>vew
<ul class="org-ul">
<li>Slice view
</li>
<li>Dtype view
</li>
</ul>
</li>
<li>shallow copy
</li>
<li>deep copy
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2">数组的in place改变</h3>
<div class="outline-text-3" id="text-4-2">
<p>
以下是不同的操作过程：
</p>
<div class="org-src-container">

<pre class="src src-python"># y = np.arange(8)
y += 1 # 更快
y = y + 1 # 更慢
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-3" class="outline-3">
<h3 id="sec-4-3">常用函数</h3>
<div class="outline-text-3" id="text-4-3">
<div class="org-src-container">

<pre class="src src-python">import numpy as np
a = np.arange(3)
b = np.arange(3,6)
c = np.r_[a, b, 1, [3]] # 合并数组
d = np.c_[a, b] # 合并数组
e = np.ones((4, 1)) # 接收元组
d.shape
d.resize(2, 3) # 无返回值，将原数组形变，接收元组
f = d.reshape(（2,3）) # 返回变形后的数组，原数组不变，接收元组
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">数据集操作的一般过程（以Kaggle Titanic为例）</h2>
<div class="outline-text-2" id="text-5">
<p>
疑问：
</p>
<ul class="org-ul">
<li>分离出测试集应该在预览数据之前还是之后？
</li>
<li>清理数据时，是对整个数据集操作还是只对训练集操作？
</li>
<li>交叉验证总是需要的吗？只是在出现过拟合时使用？
</li>
</ul>
<p>
Jupyter Notebook:
<a href="titanic-a_data_science_framework_to_achieve_99_accuracy.ipynb">titanic-a<sub>data</sub><sub>science</sub><sub>framework</sub><sub>to</sub><sub>achieve</sub><sub>99</sub><sub>accuracy</sub>.ipynb</a>
</p>
</div>
<div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1">加载数据</h3>
<div class="outline-text-3" id="text-5-1">
<p>
Kaggle网站上Titanic竞赛中的数据集test.csv指求解时的实例，去掉了标签'Survived'.
</p>
<div class="org-src-container">

<pre class="src src-python" id="read">import pandas as pd
df = pd.read_csv("train.csv") # , delimiter=',')
df2 = pd.read_csv("test.csv") # , delimiter=',')
</pre>
</div>
<ul class="org-ul">
<li>要注意Python中赋值时，引用与复制数据的区别！
</li>
</ul>
<div class="org-src-container">

<pre class="src src-python" id="cp">data1 = df.copy(deep=False) #不复制df的indices和数据，只创建一个指向原数据的引用
data1 = df.copy(deep=True) #复制df的indices和数据，并在内存中创建新的对象
</pre>
</div>
<ul class="org-ul">
<li>引用也是很有用的，尤其是在<a href="#sec-5-3">清理数据</a>时（为什么要清理data-val？）
</li>
</ul>
<div class="org-src-container">

<pre class="src src-python" id="celan_by_reference">data_clearner = [data1, df2] #可以一起清理
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-2" class="outline-3">
<h3 id="sec-5-2">预览数据</h3>
<div class="outline-text-3" id="text-5-2">
<div class="org-src-container">

<pre class="src src-python" id="preview">df.info()
df.head()
df.tail()
df.sample(10)
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-3" class="outline-3">
<h3 id="sec-5-3">清理数据</h3>
<div class="outline-text-3" id="text-5-3">
<p>
4个'C':
</p>
<ul class="org-ul">
<li><b>Correcting</b>: 更正异常值，离群值
</li>
<li><b>Completing</b>: 补全缺失信息
</li>
<li><b>Creating</b>: 创建新的特征，用以之后的分析
</li>
<li><b>Converting</b>: 转换数据的格式，以备后续的计算与呈现
</li>
</ul>
</div>

<div id="outline-container-sec-5-3-1" class="outline-4">
<h4 id="sec-5-3-1">3.3.1 Completing</h4>
<div class="outline-text-4" id="text-5-3-1">
<p>
不推荐删除记录，尤其当它占的比例大时。最好impute. 对于定性值，
一般使用mode，对于定量值一般用中值、平均值或以平均值+随机化的标准差来代替。
还有针对具体问题更特殊的处理方法，如代之以某个小类别中的中值等。
</p>
<div class="org-src-container">

<pre class="src src-python">df.isna().sum() # 查看数据中的空值情况
df.isnull().sum() # 查看数据中的空值情况
df.describe(include='all') #数据的简单分析
df['Age'].fillna(df['Age'].median(), inplace=True) # 用中值来补全空值（定量值）
df['Embarked'].fillna(df['Embarked'].mode()[0], inplace=True)
# 用出现最的类别来补全空值（定性值）
drop_index = ['PassengerId', 'Ticket'] # index to drop
df.drop(drop_index, axis=1, inplace=True) # drop features/columns
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-3-2" class="outline-4">
<h4 id="sec-5-3-2">3.3.2 Creating</h4>
<div class="outline-text-4" id="text-5-3-2">
<p>
特征工程：用已经存在的特征来创造新的特征，以检查是否对结果预测提供新的信息。
</p>
<div class="org-src-container">

<pre class="src src-python">df['FamilySize'] = df.['SibSp'] + df.['Parch'] + 1 # 新建特征
df['Alone'] = 0
df['Alone'].loc[df['FamilySize'] &gt; 1] = 1 # 选择性赋值
df['Title'] = df['Name'].str.split( # 特征中字符串截取
   ', ', expand=True)[1].str.split('.', expand=True)[0]
df['FareBins'] = pd.cut(df['Fare'], 4) # 离散化连续值到区间
df['AgeBins'] = pd.qcut(df['Age'].astype(int), 5) # 离散化连续值到区间
# 清理类别数太少的类别
title_name = df['Title'].value_counts() &lt; 10
df['Title'] = df['Title'].apply(lambda x: 'Misc' if title_name[x] else x)
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-3-3" class="outline-4">
<h4 id="sec-5-3-3">3.3.3 Converting</h4>
<div class="outline-text-4" id="text-5-3-3">
<p>
如对object类型的数据格式化，使算法可以处理。
</p>
<div class="org-src-container">

<pre class="src src-python">from sklearn.preprocessing import LabelEncoder OneHotEncoder
# 数字型编码
encoder = LabelEncoder()
df['Sex']  = encoder.fit_transform(df['Sex'])
# 独热向量编码， 接收二维数组
encoder2 = OneHotEncoder()
df['Sex']  = encoder2.fit_transform(df['Sex'].reshape(-1,1))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-5-4" class="outline-3">
<h3 id="sec-5-4">从训练集中分离出测试集</h3>
<div class="outline-text-3" id="text-5-4">
<p>
两种方法：
</p>
<ul class="org-ul">
<li>固定比例分离
</li>
</ul>
<div class="org-src-container">

<pre class="src src-python">train1_x, test1_x, train1_y, test1_y = model_selection.train_test_split(data1[data1_x_calc], data1[Target], random_state = 0)
</pre>
</div>
<ul class="org-ul">
<li>交叉验证（用以比较模型）
</li>
</ul>
<div class="org-src-container">

<pre class="src src-example">model_selection.cross_val_score()
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-5" class="outline-3">
<h3 id="sec-5-5">分析数据，找到关联性</h3>
<div class="outline-text-3" id="text-5-5">
<div class="org-src-container">

<pre class="src src-python">df[['Sex', 'Survived']].groupby('Sex',as_index=False).mean() # 特定特征与标签的关系
# 图示某一个特征与标签的关系
plt.hist(x = [df[df['Survived']==1]['Fare'], df[df['Survived']==0]['Fare']],
         stacked=True, color = ['g','r'],label = ['Survived','Dead'])
plt.title('Fare Histogram by Survival')
plt.xlabel('Fare ($)')
plt.ylabel('# of Passengers')
plt.legend()
# 图示某两个特征与标签的关系
sns.violinplot(x = 'Pclass', y = 'Age', hue = 'Survived', data = data1, split = True, ax = axis2)
axis2.set_title('Pclass vs Age Survival Comparison')
# Pearson关联
df.corr()
</pre>
</div>

<p>
Pearson关联的绘图函数：
</p>
<div class="org-src-container">

<pre class="src src-python">#correlation heatmap of dataset
def correlation_heatmap(df):
    _ , ax = plt.subplots(figsize =(14, 12))
    colormap = sns.diverging_palette(220, 10, as_cmap = True)

    _ = sns.heatmap(
        df.corr(),
        cmap = colormap,
        square=True,
        cbar_kws={'shrink':.9 },
        ax=ax,
        annot=True,
        linewidths=0.1,vmax=1.0, linecolor='white',
        annot_kws={'fontsize':12 }
    )

    plt.title('Pearson Correlation of Features', y=1.05, size=15)

correlation_heatmap(data1)
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-6" class="outline-3">
<h3 id="sec-5-6">模型化数据集</h3>
<div class="outline-text-3" id="text-5-6">
</div><div id="outline-container-sec-5-6-1" class="outline-4">
<h4 id="sec-5-6-1">背景知识</h4>
<div class="outline-text-4" id="text-5-6-1">
<p>
机器学习算法可以分为四个部分：
</p>
<ul class="org-ul">
<li>分类
</li>
<li>回归
</li>
<li>聚类
</li>
<li>降维
</li>
</ul>
<p>
机器学习知识：
</p>
<ul class="org-ul">
<li><a href="https://scikit-learn.org/stable/user_guide.html">Sklearn Estimator Overview</a>
</li>
<li><a href="https://scikit-learn.org/stable/modules/classes.html">Sklearn Estimator Detail</a>
</li>
<li><a href="https://scikit-learn.org/stable/tutorial/machine_learning_map/index.html">Choosing Estimator Mind Map</a>
</li>
</ul>

<div class="figure">
<p><img src="images/sklearn_mindmap.png" alt="sklearn_mindmap.png" width="900px" />
</p>
</div>
<ul class="org-ul">
<li><a href="https://s3.amazonaws.com/assets.datacamp.com/blog_assets/Scikit_Learn_Cheat_Sheet_Python.pdf">Choosing Estimator Cheat Sheet</a>
</li>
</ul>

<div class="figure">
<p><img src="images/cheatsheet.png" alt="cheatsheet.png" />
</p>
</div>

<p>
解决有监督的分类问题的算法：
</p>
<ul class="org-ul">
<li>Ensemble Methods
</li>
<li>Generalized Linear Models (GLM)
</li>
<li>Naive Bayes
</li>
<li>Nearest Neighbors
</li>
<li>Support Vector Machines (SVM)
</li>
<li>Decision Trees
</li>
<li>Discriminant Analysis
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6">注意点（摘自机器学习实战）</h2>
<div class="outline-text-2" id="text-6">
<ul class="org-ul">
<li>对收入分层抽样，不能分太多层
</li>
<li>分层方法：除以1.5，向上取整；然后合并大于5的分类
</li>
<li>地理数据可视化，用其他相关属性作为颜色，和散点大小
</li>
<li>寻找与标签相关性高的属性，用df.corr()['labels']
</li>
<li>进一步考察高相关性属性的数据模式，并删除可能的错误数据
</li>
<li>尝试不同的属性组合，以找到高相关性特征
</li>
<li>将预测器与标签分离，因为可能不一定对它们使用相同的转换方式
</li>
<li>特征缩放（归一化、标准化），即同比缩放所有属性
</li>
<li>评估训练得的模型，对训练集求RMSE或MAE
</li>
<li>误差较大则拟合不足，可以
</li>
<li>误差过小？则用验证集来验证得到的模型，以检查是否过拟合
</li>
<li>交叉验证，可以sklearn的K-fold功能
</li>
<li>如果在验证集上得到的误差大则说明确实有过拟合，需要更换模型
</li>
<li>尝试多个模型以找到2-5个有效的模型，别花太多时间去调整超参数
</li>
<li>保存每个尝试过的模型，用pickel或sklearn的joblib
</li>
<li>训练集分数明显低于验证集分数，则过度拟合
</li>
<li>注意：目标值一般不进行绽放，并且只对训练集缩放
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7">机器学习实战</h2>
<div class="outline-text-2" id="text-7">
</div><div id="outline-container-sec-7-1" class="outline-3">
<h3 id="sec-7-1">第四章 训练模型</h3>
<div class="outline-text-3" id="text-7-1">
</div><div id="outline-container-sec-7-1-1" class="outline-4">
<h4 id="sec-7-1-1">4.1 线性回归 Linear Regression</h4>
<div class="outline-text-4" id="text-7-1-1">
<p>
用以描述线性化数据集，模型或假设（hypothesis）是特征（x）的线性函数,或者写成向量形式，令\(x_0 = 1\):
</p>

<div class="figure">
<p><img src="images/linear_hypothsis.png" alt="linear_hypothsis.png" align="center" width="400px" />
</p>
</div>

<p>
上面的表达式也称之为回归方程（regression equation），\theta为回归系数。
成本函数，MSE函数：
</p>

<div class="figure">
<p><img src="images/MSE.png" alt="MSE.png" width="400px" />
</p>
</div>
</div>
<ul class="org-ul"><li><a id="sec-7-1-1-1" name="sec-7-1-1-1"></a>4.1.1 闭式解-标准方程（normal equation）<br  /><div class="outline-text-5" id="text-7-1-1-1">
<p>
即直接通过解析表达式计算得到参数向量&theta;:
</p>

<div class="figure">
<p><img src="images/normal_equation.png" alt="normal_equation.png" width="200px" />
</p>
</div>

<p>
可以使用Numpy的线性代数模块np.linalg中的inv()函数来求矩阵逆，用dot()方法计算内积。
特征数量大时标准方程计算极其缓慢，此时可以用迭代优化法。
</p>

<p>
<b>注意</b> ：
</p>
<pre class="example">
书中有误，Scikit-Learn的LinearRegression类并不是标准方程的实现，而是基于X的SVD分解。其时间复杂度为O(n^2)，在m&lt;n或特征线性相关时依然可以工作（标准方程不行，因为不满秩）。
LinearRegression类不需要对特征进行标度。
</pre>
<div class="org-src-container">

<pre class="src src-python">from sklearn.linear_model import LinearRegression
lin_reg = LinearRegression() # 基于scipy.linalg.lstsq()
lin_reg.fit(X, y)
lin_reg.intercept_, lin_reg.coef_ # 偏置\theta_0与权重\theta_i
lin_reg.predict(X_new) # 预测
# 可能直接调用lstsq()，意为最小平方
theta_best_svd, residuals, rank, s = np.linalg.lstsq(X_b, y, rcond=1e-6)
theta_best_svd
</pre>
</div>
</div>
</li>
<li><a id="sec-7-1-1-2" name="sec-7-1-1-2"></a>4.1.2 梯度下降(迭代优化)<br  /><div class="outline-text-5" id="text-7-1-1-2">
<p>
从随机值开始，每一步降低成本函数，直到成本函数最小值。每一步的步长取决于超参数: <i>学习率</i> <i>&eta;</i> ( <i>learning rate</i> ).
</p>

<p>
<b>注意</b> ：
</p>
<ul class="org-ul">
<li>线性回归模型的MSE是凸函数，没有局部最小，只一个全局最小。
</li>
<li>应用梯度下降时要保证所有特征数值大小比例差不多，即要先进行特征缩放！
</li>
<li>特征缩放主要有两种方式：standerization和normalization，见第二章，68页。
</li>
<li>可以使用sklearn的StandardScaler类。
</li>
<li>学习率的选取很关键，可以限制迭代次数进行网格搜索。
</li>
</ul>
</div>
<ul class="org-ul"><li><a id="sec-7-1-1-2-1" name="sec-7-1-1-2-1"></a>4.1.2.1 批量梯度下降<br  /><div class="outline-text-6" id="text-7-1-1-2-1">
<p>
在计算梯度下降的每一步时，都基于整个训练集。训练集庞大时很耗时，但随特征数增大时，算法表现良好。
</p>
</div>
</li>
<li><a id="sec-7-1-1-2-2" name="sec-7-1-1-2-2"></a>4.1.2.2 随机梯度下降<br  /><div class="outline-text-6" id="text-7-1-1-2-2">
<p>
在计算梯度下降的每一步时，只随机地使用一个训练集实例。训练集庞大时很耗时，但随特征数增大时，算法表现良好。
</p>
<ul class="org-ul">
<li>当成本函数有局部最小时，可以跳出局部最小，找到全局最小
</li>
<li>设定 <i>学习计划</i> ，开始时大步长，最后小步长（模拟退火）
</li>
<li>乱序训练集使一个接一个地使用实例，反而会导致收敛更慢！
</li>
</ul>
<div class="org-src-container">

<pre class="src src-python">from sklearn.linear_model import SGDRegressor
sgd_reg = SGDRegressor(max_iter=50, tol=-np.infty, penalty=None, eta0=0.1, random_state=42)
sgd_reg.fit(X, y.ravel())
sgd_reg.intercept_, sgd_reg.coef_
</pre>
</div>
</div>
</li>
<li><a id="sec-7-1-1-2-3" name="sec-7-1-1-2-3"></a>4.1.2.3 小批量梯度下降<br  /><div class="outline-text-6" id="text-7-1-1-2-3">
<p>
在计算梯度下降的每一步时，只随机地使用一个小的实例集。主要优势在于可以用GPU加速计算。
</p>
</div>
</li></ul>
</li>
<li><a id="sec-7-1-1-3" name="sec-7-1-1-3"></a>4.1.3 标准方程与梯度下降对比<br  /><div class="outline-text-5" id="text-7-1-1-3">

<div class="figure">
<p><img src="images/normal-GD.png" alt="normal-GD.png" width="800px" />
</p>
</div>
</div>
</li></ul>
</div>
<div id="outline-container-sec-7-1-2" class="outline-4">
<h4 id="sec-7-1-2">多项式回归 Polynomial Regression</h4>
<div class="outline-text-4" id="text-7-1-2">
</div>
</div>
<div id="outline-container-sec-7-1-3" class="outline-4">
<h4 id="sec-7-1-3">逻辑回归 Logistic Regression</h4>
</div>
<div id="outline-container-sec-7-1-4" class="outline-4">
<h4 id="sec-7-1-4">多元逻辑回归 Softmax Regression (Multinomial Regression)</h4>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: <span class="timestamp-wrapper"><span class="timestamp">&lt;2020-02-27 Thu&gt;</span></span></p>
<p class="author">Author: GoldenRaven</p>
<p class="date">Created: 2020-03-02 一 12:43</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.2.2 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
