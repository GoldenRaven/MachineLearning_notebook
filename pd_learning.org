# -*- org -*-
#+TITLE: Python语言扩展库Pandas笔记
#+AUTHOR: GoldenRaven
#+DATE: <2020-02-27 Thu>
#+email: li.gaoyang@live.com
* Series
* DataFrame
- DataFrame中的方法属性：
#+NAME: df_methods
#+BEGIN_src example
'T', 'abs', 'add', 'add_prefix', 'add_suffix', 'agg', 'aggregate', 'align', 'all',
'any', 'append', 'apply', 'applymap', 'asfreq', 'asof', 'assign', 'astype',
'at', 'at_time', 'attrs', 'axes', 'between_time', 'bfill', 'bool', 'boxplot',
'clip', 'columns', 'combine', 'combine_first', 'convert_dtypes', 'copy', 'corr',
'corrwith', 'count', 'cov', 'cummax', 'cummin', 'cumprod', 'cumsum', 'describe',
'diff', 'div', 'divide', 'dot', 'drop', 'drop_duplicates', 'droplevel', 'dropna',
'dtypes', 'duplicated', 'empty', 'eq', 'equals', 'eval', 'ewm', 'expanding',
'explode', 'ffill', 'fillna', 'filter', 'first', 'first_valid_index', 'floordiv',
'from_dict', 'from_records', 'ge', 'get', 'groupby', 'gt', 'head', 'hist', 'iat',
'idxmax', 'idxmin', 'iloc', 'index', 'infer_objects', 'info', 'insert',
'interpolate', 'isin', 'isna', 'isnull', 'items', 'iteritems', 'iterrows',
'itertuples', 'join', 'keys', 'kurt', 'kurtosis', 'last', 'last_valid_index',
'le', 'loc','lookup', 'lt', 'mad', 'mask', 'max', 'mean', 'median', 'melt',
'memory_usage', 'merge', 'min', 'mod', 'mode', 'mul', 'multiply', 'ndim', 'ne',
'nlargest', 'notna', 'notnull', 'nsmallest', 'nunique', 'pct_change', 'pipe',
'pivot', 'pivot_table', 'plot', 'pop', 'pow', 'prod', 'product', 'quantile',
'query', 'radd', 'rank', 'rdiv', 'reindex', 'reindex_like', 'rename',
'rename_axis', 'reorder_levels', 'replace', 'resample','reset_index', 'rfloordiv',
'rmod', 'rmul', 'rolling', 'round', 'rpow', 'rsub', 'rtruediv', 'sample',
'select_dtypes', 'sem', 'set_axis', 'set_index', 'shape', 'shift', 'size',
'skew', 'slice_shift', 'sort_index', 'sort_values', 'sparse', 'squeeze', 'stack',
'std', 'style', 'sub', 'subtract', 'sum', 'swapaxes', 'swaplevel', 'tail', 'take',
'to_clipboard', 'to_csv', 'to_dict', 'to_excel', 'to_feather', 'to_gbq', 'to_hdf',
'to_html', 'to_json', 'to_latex', 'to_markdown', 'to_numpy', 'to_parquet',
'to_period', 'to_pickle', 'to_records', 'to_sql', 'to_stata', 'to_string',
'to_timestamp', 'to_xarray', 'transform', 'transpose', 'truediv', 'truncate',
'tshift', 'tz_convert', 'tz_localize', 'unstack', 'update', 'values', 'var',
'where', 'xs'
#+END_SRC

* 数据操作一般过程
** 加载数据
Kaggle网站上Titanic竞赛中的数据集test.csv指求解时的实例，去掉了标签'Survived'.
#+NAME: read
#+BEGIN_src python
import pandas as pd
df = pd.read_csv("train.csv") # , delimiter=',')
df2 = pd.read_csv("test.csv") # , delimiter=',')
#+END_SRC
- 要注意Python中赋值时，引用与复制数据的区别！
#+NAME: cp
#+BEGIN_src python
data1 = df.copy(deep=False) #不复制df的indices和数据，只创建一个指向原数据的引用
data1 = df.copy(deep=True) #复制df的indices和数据，并在内存中创建新的对象
#+END_SRC
- 引用也是很有用的，尤其是在清理内存时
#+NAME: celan_by_reference
#+BEGIN_src python
data_clearner = [data1, df2] #可以一起清理
#+END_SRC
** 预览数据
#+NAME: preview
#+BEGIN_src python
df.info()
df.head()
df.tail()
df.sample(10)
#+END_SRC
** 清理数据
4个'C':
- *Correcting*: 更正异常值，离群值
- *Completing*: 补全缺失信息
- *Creating*: 创建新的特征，用以之后的分析
- *Converting*: 转换数据的格式，以备后续的计算与呈现

*** Completing
不推荐删除记录，尤其当它占的比例大时。最好impute. 对于定性值，
一般使用mode，对于定量值一般用中值、平均值或以平均值+随机化的标准差来代替。
还有针对具体问题更特殊的处理方法，如代之以某个小类别中的中值等。
#+BEGIN_src python
df.isna().sum() # 查看数据中的空值情况
df.isnull().sum() # 查看数据中的空值情况
df.describe(include='all') #数据的简单分析
df['Age'].fillna(df['Age'].median(), inplace=True) # 用中值来补全空值（定量值）
df['Embarked'].fillna(df['Embarked'].mode()[0], inplace=True)
# 用出现最的类别来补全空值（定性值）
drop_index = ['PassengerId', 'Ticket'] # index to drop
df.drop(drop_index, axis=1, inplace=True) # drop features/columns
#+END_SRC
*** Creating
特征工程：用已经存在的特征来创造新的特征，以检查是否对结果预测提供新的信息。
#+BEGIN_src python

#+END_SRC
*** Converting
如对object类型的数据格式化，使算法可以处理。
*** 常用函数



E: clean_by_reference
#+BEGIN_src python
data = [data1, df]
#+END_SRC
